<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>StayWorld â€” Host Register</title>

  <link rel="stylesheet" href="/styles.css" />
  <!-- ê³µí†µ ìŠ¤í¬ë¦½íŠ¸ë“¤ (ë„¤ ì‚¬ì´íŠ¸ì˜ ê³µí†µ includeì™€ ë™ì¼ ìˆœì„œ ê¶Œìž¥) -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin="anonymous"></script>
  <script src="/scripts/firebase-config.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-storage-compat.js"></script>
  <!-- Firestoreë¥¼ ë„¤ê°€ firebase.jsì—ì„œ ì´ˆê¸°í™”í•´ window.firebaseDBë¡œ ë‚´ë³´ë‚´ë©´ ê·¸ëŒ€ë¡œ ì‚¬ìš©ë¨ -->
  <script src="/scripts/firebase.js"></script>
  <script src="/scripts/auth.js"></script>
  <script src="/lang.js"></script>
  <script src="/app.js"></script>

  <style>
    .container { max-width: 960px; margin: 40px auto; padding: 0 16px; }
    .card { background: var(--panel,#101018); border: 1px solid var(--line,rgba(255,255,255,.08)); border-radius: 16px; padding: 18px; }
    .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; }
    .row { display:flex; flex-direction:column; gap:6px; }
    label { font-size: 13px; opacity: .85; }
    input, select, textarea { background: #0d1117; border: 1px solid #222; color: #e7e9ee; padding:10px; border-radius:10px; }
    .btn { padding: 10px 14px; border-radius: 10px; border: 1px solid #333; cursor: pointer; }
    .btn.primary { background: #c9a35b; border-color: #c9a35b; color: #111; font-weight: 600; }
    .muted { color: #cfd6e6; opacity: .8; font-size: 13px; }
    .thumbs { display:flex; gap:10px; flex-wrap: wrap; margin-top:8px;}
    .thumbs img { width: 90px; height: 90px; object-fit: cover; border-radius: 10px; border:1px solid #222; }
    .two { display:grid; grid-template-columns: 1fr 1fr; gap:10px; }
  </style>
</head>
<body>
  <div id="global-header"></div>

  <main class="container">
    <h1>Register a Listing</h1>
    <p class="muted">Fill out details below. Photos are optional (up to 5).</p>

    <div class="card">
      <form id="hostForm">
        <div class="grid">
          <div class="row">
            <label>Title</label>
            <input id="title" required placeholder="e.g., Bosphorus View Suite" />
          </div>
          <div class="row">
            <label>City</label>
            <input id="city" required placeholder="e.g., Istanbul" />
          </div>
          <div class="row">
            <label>Country</label>
            <input id="country" required placeholder="e.g., TÃ¼rkiye" />
          </div>
          <div class="row">
            <label>Stay Type</label>
            <select id="stayType" required>
              <option value="Hotel">Hotel</option>
              <option value="Motel">Motel</option>
              <option value="Hostel">Hostel</option>
              <option value="Apartment">Apartment</option>
              <option value="Villa">Villa</option>
              <option value="Ryokan">Ryokan</option>
              <option value="Guesthouse">Guesthouse</option>
              <option value="B&B">B&B</option>
            </select>
          </div>
          <div class="row">
            <label>Price</label>
            <div class="two">
              <input id="price" type="number" min="1" step="1" required placeholder="e.g., 120" />
              <select id="currency" required>
                <option value="USD">USD</option>
                <option value="TRY">TRY</option>
                <option value="KRW">KRW</option>
                <option value="EUR">EUR</option>
                <option value="JPY">JPY</option>
                <option value="CNY">CNY</option>
                <option value="RUB">RUB</option>
              </select>
            </div>
            <small class="muted">We will store price in USD internally for filtering/sorting.</small>
          </div>
          <div class="row">
            <label>Distance to center (km)</label>
            <input id="distance" type="number" min="0" step="0.1" placeholder="e.g., 1.2" />
          </div>
          <div class="row">
            <label>Rating (0 ~ 5)</label>
            <input id="rating" type="number" min="0" max="5" step="0.1" placeholder="e.g., 4.6" />
          </div>
          <div class="row">
            <label>Free cancellation</label>
            <select id="freeCancel">
              <option value="true">Yes</option>
              <option value="false">No</option>
            </select>
          </div>
          <div class="row">
            <label>Latitude / Longitude (optional)</label>
            <div class="two">
              <input id="lat" type="number" step="0.000001" placeholder="41.0082" />
              <input id="lng" type="number" step="0.000001" placeholder="28.9784" />
            </div>
            <small class="muted">Optional. Used for map or MyPage favorites map.</small>
          </div>
          <div class="row" style="grid-column:1/-1">
            <label>Description</label>
            <textarea id="desc" rows="4" placeholder="Tell guests about the space, amenities, rules..."></textarea>
          </div>
          <div class="row" style="grid-column:1/-1">
            <label>Photos (up to 5)</label>
            <input id="photos" type="file" accept="image/*" multiple />
            <div id="thumbs" class="thumbs"></div>
          </div>
        </div>
        <div style="margin-top:16px; display:flex; gap:10px;">
          <button class="btn primary" type="submit">Publish Listing</button>
          <button class="btn" type="button" id="btnDraft">Save as Draft</button>
        </div>
        <p id="msg" class="muted" style="margin-top:10px;"></p>
      </form>
    </div>
  </main>

  <div id="global-footer"></div>

  <script src="/scripts/hosts.js"></script>
  <script type="module" src="/scripts/auth-ui.js"></script>
  <script>
/**
 * ë¡œê·¸ì¸ ì‹œ localStorage.sw_user ë¥¼ ê¸°ì¤€ìœ¼ë¡œ
 * - ê²ŒìŠ¤íŠ¸ìš© ë²„íŠ¼/ë§í¬(Login, Sign up, data-auth="guest") ìˆ¨ê¹€
 * - ìœ ì €ìš© UI(My Page, Logout, data-auth="user") í‘œì‹œ
 * - Logout í´ë¦­ ë™ìž‘ ì—°ê²°
 */
(function () {
  const user = JSON.parse(localStorage.getItem('sw_user') || 'null');

  const show = (sel) => document.querySelectorAll(sel).forEach(el => el.style.display = '');
  const hide = (sel) => document.querySelectorAll(sel).forEach(el => el.style.display = 'none');

  if (user) {
    // ë¡œê·¸ì¸ ìƒíƒœ: ê²ŒìŠ¤íŠ¸ìš© ìˆ¨ê¸°ê³  ìœ ì €ìš© ë³´ì—¬ì£¼ê¸°
    hide('a[href="/login.html"], a[href="/signup.html"], [data-auth="guest"]');
    show('[data-auth="user"]');

    // í™˜ì˜ ë¬¸êµ¬ ê°±ì‹ (ìžˆì„ ë•Œë§Œ)
    const welcomeEl = document.getElementById('welcomeUser');
    if (welcomeEl) welcomeEl.textContent = `Welcome, ${user.name} ðŸŽ‰`;
  } else {
    // ë¹„ë¡œê·¸ì¸: ê²ŒìŠ¤íŠ¸ìš© ë³´ì´ê³  ìœ ì €ìš© ìˆ¨ê¸°ê¸°
    show('a[href="/login.html"], a[href="/signup.html"], [data-auth="guest"]');
    hide('[data-auth="user"]');
  }

  // ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ ë™ìž‘(ì—¬ëŸ¬ ì•„ì´ë””/ì†ì„± ì§€ì›)
  document.querySelectorAll('#logoutBtn, [data-logout]').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.preventDefault();
      localStorage.removeItem('sw_user');
      location.href = '/index.html';
    });
  });
})();
</script>

</body>

</html>
