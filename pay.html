<!doctype html><html lang="en"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Pay with Crypto — STAYWORLD</title><link rel="stylesheet" href="/style.css">
</head><body>
<main class="container hero"><h1>Pay with Crypto (USDT · TRC20)</h1>
<div class="card" style="max-width:720px"><label>Amount (USD)</label>
<input id="amount" type="number" step="0.01" min="1" placeholder="199.00" style="width:100%">
<div style="display:flex;gap:10px;margin-top:10px"><button id="go" class="btn btn-gold">Continue to checkout</button><a href="/" class="btn">Back</a></div>
<div id="msg" style="color:#b9b9c5;margin-top:10px"></div></div></main>
<script>
document.getElementById('go').addEventListener('click', async () => {
  const a = document.getElementById('amount').value.trim();
  if(!a || Number(a)<=0){ document.getElementById('msg').textContent='Enter a valid amount.'; return; }
  document.getElementById('msg').textContent='Creating secure checkout...';
  try{
    const r = await fetch('/.netlify/functions/np-create-invoice', {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ amount: Number(a) })});
    const d = await r.json();
    if(!r.ok || !d.invoice_url) throw new Error(d?.message || 'Failed to create invoice');
    location.href = d.invoice_url;
  }catch(e){ document.getElementById('msg').textContent='Error: ' + (e.message||e); }
});
</script></body></html>
