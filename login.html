<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>StayWorld 로그인</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<!-- 로그인 버튼 -->
<button onclick="openLogin()" class="btn btn-gold">로그인</button>

<!-- 로그인 모달 -->
<dialog id="loginModal" class="rounded-xl p-0 w-full max-w-md bg-[#0f0f15] text-white shadow-lg"></dialog>

<!-- 로그인 템플릿 -->
<template id="loginTpl">
  <div class="p-5 space-y-3">
    <h3 class="text-lg font-bold mb-2">로그인</h3>
    <input id="loginEmail" type="email" class="w-full px-4 py-3 rounded-xl bg-[#0f0f15] border border-white/10" placeholder="이메일">
    <input id="loginPwd" type="password" class="w-full px-4 py-3 rounded-xl bg-[#0f0f15] border border-white/10" placeholder="비밀번호">
    <button data-login-submit class="btn btn-gold w-full">이메일로 로그인</button>
    <button id="googleLoginBtn" class="btn w-full bg-white text-black flex items-center justify-center gap-2">
      <span class="text-lg">G</span> Google로 계속하기
    </button>
  </div>
</template>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-auth-compat.js"></script>

<!-- StayWorld Firebase 설정 -->
<script>
window.firebaseConfig = {
  apiKey: "AIzaSyD7EXAMPLE-API-KEY",
  authDomain: "stayworldglobal.firebaseapp.com",
  projectId: "stayworldglobal",
  storageBucket: "stayworldglobal.appspot.com",
  messagingSenderId: "1234567890",
  appId: "1:1234567890:web:abcdef123456"
};
firebase.initializeApp(window.firebaseConfig);
window._fbReady = true;
</script>

<!-- 로그인 로직 -->
<script>
(function(){
  const $ = (sel, scope)=> (scope||document).querySelector(sel);

  function openLogin(){
    const dlg = $('#loginModal');
    const tpl = $('#loginTpl');
    if (dlg && tpl){
      dlg.innerHTML = tpl.innerHTML;
      dlg.showModal();
      hydrateActions(dlg);
    }
  }

  function closeLogin(){
    const dlg = $('#loginModal');
    if (dlg && dlg.open) dlg.close();
  }

  function hydrateActions(container){
    container.querySelector('[data-login-submit]')?.addEventListener('click', doLogin);
    container.querySelector('#googleLoginBtn')?.addEventListener('click', googleLogin);
  }

  function doLogin(){
    const email = $('#loginEmail')?.value;
    const pwd = $('#loginPwd')?.value;
    firebase.auth().signInWithEmailAndPassword(email, pwd)
      .then(user=>{ alert(`로그인 성공: ${user.user.email}`); closeLogin(); })
      .catch(e=> alert(e.message));
  }

  function googleLogin(){
    const provider = new firebase.auth.GoogleAuthProvider();
    firebase.auth().signInWithPopup(provider)
      .then(result=>{ alert(`환영합니다, ${result.user.displayName}`); closeLogin(); })
      .catch(e=> alert(e.message));
  }

  window.openLogin = openLogin;
})();
</script>

</body>
</html>
