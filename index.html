<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>StayWorld | Global Stays</title>
  <link rel="stylesheet" href="style.css" />
  <script src="lang.js" defer></script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const langSelect = document.getElementById("languageSelect");
      const elements = document.querySelectorAll("[data-lang]");

      function applyTranslations(lang) {
        const translations = window.translations || {};
        const selected = translations[lang];
        if (!selected) return;
        elements.forEach(el => {
          const key = el.getAttribute("data-lang");
          if (selected[key]) el.textContent = selected[key];
        });
      }

      langSelect?.addEventListener("change", () => {
        applyTranslations(langSelect.value);
      });

      applyTranslations(langSelect?.value || "en");

      document.getElementById("searchBtn")?.addEventListener("click", () => {
        const input = document.getElementById("searchInput").value.toLowerCase();
        if (input) {
          window.location.href = `results.html?query=${encodeURIComponent(input)}`;
        } else {
          alert("❗ 검색어를 입력하세요");
        }
      });

      document.getElementById("chatBtn")?.addEventListener("click", () => {
        alert("💬 AI 챗봇이 곧 연결됩니다 (예시)");
      });

      document.querySelector('#login .btn-primary')?.addEventListener("click", () => {
        alert("🔐 로그인 페이지로 이동합니다 (예시)");
      });

      document.querySelector('#login .btn-secondary')?.addEventListener("click", () => {
        alert("📝 회원가입 페이지로 이동합니다 (예시)");
      });

      document.getElementById("reserveBtn")?.addEventListener("click", () => {
        alert("📅 예약이 시작됩니다 (예시)");
      });

      const searchInput = document.getElementById("searchInput");
      const datalist = document.createElement("datalist");
      datalist.id = "city-suggestions";

      const suggestions = [
        "Istanbul", "Paris", "Tokyo", "New York", "Barcelona",
        "Seoul", "Bangkok", "Dubai", "London", "Berlin",
        "Rome", "Moscow", "Shanghai", "Los Angeles", "Cape Town"
      ];
      suggestions.forEach(city => {
        const option = document.createElement("option");
        option.value = city;
        datalist.appendChild(option);
      });
      document.body.appendChild(datalist);
      searchInput.setAttribute("list", "city-suggestions");

      const recommendBox = document.getElementById("recommended-destinations");
      if (recommendBox) {
        recommendBox.innerHTML = suggestions.map(city => `<button class="recommend-city">${city}</button>`).join(" ");
        document.querySelectorAll(".recommend-city").forEach(btn => {
          btn.addEventListener("click", () => {
            window.location.href = `results.html?query=${encodeURIComponent(btn.textContent)}`;
          });
        });
      }

      const hotels = ["Seoul Grand Hotel", "Tokyo Bay Resort", "Paris Luxe Suite"];
      const hotelBox = document.getElementById("recommended-hotels");
      if (hotelBox) {
        hotelBox.innerHTML = hotels.map(name => `<div class="recommend-hotel">🏨 ${name}</div>`).join("");
      }

      const levelBox = document.getElementById("level-status");
      if (levelBox) {
        const currentPoints = 1800000;
        const nextLevel = 2000000;
        const daysSinceLast = 45;

        const progress = Math.min(100, Math.floor((currentPoints / nextLevel) * 100));
        const downgrade = daysSinceLast >= 60 ? "⚠️ 레벨 강등 예정!" : "유지 중";

        levelBox.innerHTML = `
          <div>🎖️ 현재 포인트: ${currentPoints.toLocaleString()} / ${nextLevel.toLocaleString()}</div>
          <div>📈 레벨업까지 ${nextLevel - currentPoints}포인트 남음</div>
          <div>⏳ 최근 활동 후 경과일: ${daysSinceLast}일 (${downgrade})</div>
          <div style="width:100%;background:#eee;height:10px;border-radius:5px;margin-top:5px;">
            <div style="width:${progress}%;height:10px;background:#4caf50;border-radius:5px;"></div>
          </div>
        `;
      }

      fetch('https://api.openweathermap.org/data/2.5/weather?q=Istanbul&appid=2ad4370f87ea28fc1d3e514b5a6f1603&units=metric')
        .then(response => response.json())
        .then(data => {
          const weatherBox = document.getElementById("weather");
          if (weatherBox) {
            const temp = data.main.temp;
            const icon = data.weather[0].icon;
            weatherBox.innerHTML = `<img src="https://openweathermap.org/img/wn/${icon}@2x.png" alt="weather" /> ${temp}°C`;
          }
        });
    });

    function initMap() {
      const location = { lat: 41.0082, lng: 28.9784 };
      const map = new google.maps.Map(document.getElementById("googleMap"), {
        zoom: 10,
        center: location,
      });
      new google.maps.Marker({ position: location, map: map });
    }
  </script>
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBHU_qCN0tthVG9j1KMWAGQvNhzZ2aEDPg&callback=initMap"></script>
</head>
<body>
  <div id="search">
    <input type="text" id="searchInput" placeholder="Search city..." />
    <button id="searchBtn" data-lang="search_button">Search</button>
  </div>
  <div id="recommended-destinations"></div>
  <div id="recommended-hotels"></div>
  <div id="googleMap" style="width:100%;height:300px;"></div>
  <div id="weather"></div>
  <div id="level-status" style="margin-top:20px;"></div>
  <section id="level-alert" style="margin: 30px 0; padding: 15px; border: 1px solid #ccc; border-radius: 8px; background: #f9f9f9;">
    <h3>🎯 내 레벨 상태</h3>
    <ul>
      <li>현재 등급: <strong>다이아몬드</strong></li>
      <li>최근 예약 활동일: <strong>45일 전</strong></li>
      <li><span style="color:red;">⚠️ 앞으로 15일 내 예약 없으면 <strong>플래티넘</strong> 등급으로 강등됩니다.</span></li>
      <li>다음 레벨 <strong>엘리트</strong>까지 남은 금액: <strong>₩1,500,000</strong></li>
      <li>레벨 유지 조건: <strong>60일 이내 최소 1회 예약</strong></li>
    </ul>
    <button onclick="alert('StayWorld+ 혜택 보기')">💎 StayWorld+ 혜택 보기</button>
  </section>
</body>
</html>
